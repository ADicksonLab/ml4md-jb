
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Week 02 Lecture: Machine Learning at the Intersection with Molecular Simulations &#8212; Machine Learning for Molecular Dynamics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/ml4md_fav.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Week 01 Lab: Python Refresher Course" href="../Week-01/W1_Lab_Python_Refresher.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Machine Learning for Molecular Dynamics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Machine Learning for Molecular Dynamics - BMB 961 Sec 003
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Materials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Course_Materials/BMB961-003_Syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Course_Materials/BMB961-003_Schedule.html">
   Course Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Course_Materials/SoftwareSetupGuide.html">
   Software Setup Guide
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 01
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/ADicksonLab/ml4md-jb/raw/main/Course_Materials/learn_python.zip">
   LearnPython.zip
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/ADicksonLab/ml4md-jb/blob/8bc6b5d18b4f72c40ad50704cb6507c58f7f595c/Course_Materials/BMB_Community_Standards.pdf">
   BMB_Community_Standards.pdf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://raw.githubusercontent.com/ADicksonLab/ml4md-jb/main/Week-01/sEH_nowater.pdb">
   sEH_nowater.pdb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-01/sEH_unbinding.dcd">
   sEH_unbinding.dcd
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week-01/W1_Lecture_Welcome.html">
   Week 01 Lecture: Welcome to ML4MD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Week-01/W1_Lab_Python_Refresher.html">
   Week 01 Lab: Python Refresher Course
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 02
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Week 02 Lecture: Machine Learning at the Intersection with Molecular Simulations
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Week-02/W2_Lecture_MLBasics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ADicksonLab/ml4md-jb"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ADicksonLab/ml4md-jb/issues/new?title=Issue%20on%20page%20%2FWeek-02/W2_Lecture_MLBasics.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ADicksonLab/ml4md-jb/main?urlpath=tree/Week-02/W2_Lecture_MLBasics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/ADicksonLab/ml4md-jb/blob/main/Week-02/W2_Lecture_MLBasics.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Week 02 Lecture: Machine Learning at the Intersection with Molecular Simulations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-brief-survey">
     A Brief Survey
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-benefit-of-ml-for-simulators">
   What is the benefit of ML for simulators?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-benefit-of-md-for-machine-learners">
   What is the benefit of MD for machine learners?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-idea-of-machine-learning">
   What is the idea of Machine Learning?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typical-tasks-of-ml">
   Typical tasks of ML
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     Regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-classification">
     Data classification
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dimensionality-reduction-and-feature-extraction">
     Dimensionality reduction and feature extraction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generation-of-high-dimensional-data">
     Generation of high-dimensional data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#models-used-in-ml">
   Models used in ML
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-regression">
     Functional regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logistic-regression">
     Logistic regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#support-vector-machines">
     Support vector machines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-trees-and-random-forests">
     Decision Trees and Random Forests
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hidden-markov-models">
     Hidden Markov Models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#neural-networks">
     Neural Networks
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#neural-network-architectures">
     Neural Network Architectures
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activation-functions">
     Activation functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ml-in-practice">
   ML in practice
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-problem-suitable-for-ml">
     Define problem suitable for ML
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#input-data-features">
     Input data features
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#target-output-data">
     Target  output data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-design">
     Model design
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-training">
     Model training
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-know-which-weights-are-optimal">
     How do we know which weights are optimal?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-find-optimal-weights">
     How do we find optimal weights?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-obtain-gradients">
     How do we obtain gradients?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-do-we-stop-with-training">
     When do we stop with training?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-optimize-training-performance">
     How do we optimize training performance?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-biases-and-incorporation-of-additional-knowledge">
     Data biases and incorporation of additional knowledge
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-ml-models">
     Using ML models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpreting-ml-models">
     Interpreting ML models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-if-we-want-to-understand-things">
     What if we want to understand things?
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Week 02 Lecture: Machine Learning at the Intersection with Molecular Simulations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Week 02 Lecture: Machine Learning at the Intersection with Molecular Simulations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-brief-survey">
     A Brief Survey
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-benefit-of-ml-for-simulators">
   What is the benefit of ML for simulators?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-benefit-of-md-for-machine-learners">
   What is the benefit of MD for machine learners?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-idea-of-machine-learning">
   What is the idea of Machine Learning?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typical-tasks-of-ml">
   Typical tasks of ML
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     Regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-classification">
     Data classification
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dimensionality-reduction-and-feature-extraction">
     Dimensionality reduction and feature extraction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generation-of-high-dimensional-data">
     Generation of high-dimensional data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#models-used-in-ml">
   Models used in ML
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-regression">
     Functional regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logistic-regression">
     Logistic regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#support-vector-machines">
     Support vector machines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-trees-and-random-forests">
     Decision Trees and Random Forests
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hidden-markov-models">
     Hidden Markov Models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#neural-networks">
     Neural Networks
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#neural-network-architectures">
     Neural Network Architectures
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#activation-functions">
     Activation functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ml-in-practice">
   ML in practice
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-problem-suitable-for-ml">
     Define problem suitable for ML
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#input-data-features">
     Input data features
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#target-output-data">
     Target  output data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-design">
     Model design
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-training">
     Model training
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-know-which-weights-are-optimal">
     How do we know which weights are optimal?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-find-optimal-weights">
     How do we find optimal weights?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-obtain-gradients">
     How do we obtain gradients?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#when-do-we-stop-with-training">
     When do we stop with training?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-do-we-optimize-training-performance">
     How do we optimize training performance?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-biases-and-incorporation-of-additional-knowledge">
     Data biases and incorporation of additional knowledge
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-ml-models">
     Using ML models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpreting-ml-models">
     Interpreting ML models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-if-we-want-to-understand-things">
     What if we want to understand things?
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section id="week-02-lecture-machine-learning-at-the-intersection-with-molecular-simulations">
<h1>Week 02 Lecture: Machine Learning at the Intersection with Molecular Simulations<a class="headerlink" href="#week-02-lecture-machine-learning-at-the-intersection-with-molecular-simulations" title="Permalink to this headline">¶</a></h1>
<section id="a-brief-survey">
<h2>A Brief Survey<a class="headerlink" href="#a-brief-survey" title="Permalink to this headline">¶</a></h2>
<p>In the next four weeks, we will cover the following topics.</p>
<ol class="simple">
<li><p>Basic concepts</p></li>
<li><p>Neural network architectures</p></li>
<li><p>Generators</p></li>
<li><p>State-of-the-art applications: AlphaFold2</p></li>
</ol>
</section>
</section>
<section id="what-is-the-benefit-of-ml-for-simulators">
<h1>What is the benefit of ML for simulators?<a class="headerlink" href="#what-is-the-benefit-of-ml-for-simulators" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>ML facilitates analysis of complex simulation data and guides sampling.</p></li>
<li><p>ML provides ‘optimal’ force fields.</p></li>
<li><p>ML now provides accurate, experiment-like structures of proteins.</p></li>
</ul>
<p>“<strong>ML complements physics-based approaches and accelerates the understanding of biology.</strong>”</p>
</section>
<section id="what-is-the-benefit-of-md-for-machine-learners">
<h1>What is the benefit of MD for machine learners?<a class="headerlink" href="#what-is-the-benefit-of-md-for-machine-learners" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>MD provides data for training, e.g. to learn how to generate dynamics</p></li>
</ul>
<p>“<strong>Why do we need to ‘understand’? ML will learn and predict everything!</strong></p>
</section>
<section id="what-is-the-idea-of-machine-learning">
<h1>What is the idea of Machine Learning?<a class="headerlink" href="#what-is-the-idea-of-machine-learning" title="Permalink to this headline">¶</a></h1>
<p><img alt="learning" src="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-02/learning.png" /></p>
<p>A model is built (automatically) based on training data:</p>
<div class="math notranslate nohighlight">
\[
  action(dog_i) = f(interactions, treats)
\]</div>
<p><img alt="trained" src="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-02/trained.png" /></p>
<p>and then used to predict outcome based on input.</p>
</section>
<section id="typical-tasks-of-ml">
<h1>Typical tasks of ML<a class="headerlink" href="#typical-tasks-of-ml" title="Permalink to this headline">¶</a></h1>
<section id="regression">
<h2>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h2>
<p><strong>Supervised learning</strong></p>
<ul class="simple">
<li><p><em>input:</em> featurized data</p></li>
<li><p><em>output:</em> continuous values</p></li>
</ul>
<p><em>Example:</em> <strong>Prediction of quantum mechanical energies from molecular configurations</strong></p>
<p><span class="math notranslate nohighlight">\( &lt;\Phi_0|e^{-T}He^{T}|\Phi_0&gt; = E \)</span></p>
<img alt="iron-sulfur cluster" src="https://upload.wikimedia.org/wikipedia/commons/9/92/OBINIX2.png" width="400"/>
</section>
<section id="data-classification">
<h2>Data classification<a class="headerlink" href="#data-classification" title="Permalink to this headline">¶</a></h2>
<p><strong>Supervised learning</strong></p>
<ul class="simple">
<li><p><em>input:</em> featurized data</p></li>
<li><p><em>output:</em> predicted categories</p></li>
</ul>
<p><em>Example:</em> <strong>Prediction of secondary structure from sequence</strong></p>
<img alt="secondary structure" src="https://resources.qiagenbioinformatics.com/manuals/clcgenomicsworkbench/current/secondary_structure_output.png" width="500"/></section>
<section id="dimensionality-reduction-and-feature-extraction">
<h2>Dimensionality reduction and feature extraction<a class="headerlink" href="#dimensionality-reduction-and-feature-extraction" title="Permalink to this headline">¶</a></h2>
<p><strong>Unsupervised learning</strong></p>
<ul class="simple">
<li><p><em>input:</em> high-dimensional data (e.g. MD simulations)</p></li>
<li><p><em>output:</em> projection of data onto low-dimensional collective variable space</p></li>
</ul>
<p><em>Example:</em> <strong>Conformational clustering and identifaction of states sampled via MD</strong></p>
<img alt="secondary structure" src="https://pubs.acs.org/na101/home/literatum/publisher/achs/journals/content/jpcafh/2021/jpcafh.2021.125.issue-28/acs.jpca.1c02869/20210715/images/medium/jp1c02869_0016.gif" width="500"/>
</section>
<section id="generation-of-high-dimensional-data">
<h2>Generation of high-dimensional data<a class="headerlink" href="#generation-of-high-dimensional-data" title="Permalink to this headline">¶</a></h2>
<p><strong>Supervised learning via advanced deep learning architectures</strong></p>
<ul class="simple">
<li><p><em>input:</em> desired features of generated objects</p></li>
<li><p><em>output:</em> ensembles of objects based on desired features and consistent with expected properties</p></li>
</ul>
<p><em>Example:</em> <strong>High-accuracy protein structure generation based on sequence</strong></p>
<img alt="AlphaFold2 prediction" src="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-02/alphafold-7m7a.png" width="600"/></section>
</section>
<section id="models-used-in-ml">
<h1>Models used in ML<a class="headerlink" href="#models-used-in-ml" title="Permalink to this headline">¶</a></h1>
<p>In the most general sense, ML models map input data to output data.</p>
<div class="math notranslate nohighlight">
\[
\color{red}{Y} = f(\color{blue}{X}; \color{green}{W}; \color{purple}{P}; \color{grey}{N})
\]</div>
<p>Model Input:
$<span class="math notranslate nohighlight">\(
\begin{matrix}
\color{blue}{\mbox{X}} &amp;  \mbox{input data} \\
\color{green}{\mbox{W}}  &amp;  \mbox{weights to be optimized} \\
\color{purple}{\mbox{P}}  &amp;  \mbox{model parameters} \\
\color{grey}{\mbox{N}}  &amp;  \mbox{random noise (optional)} \\
\end{matrix} 
\)</span>$</p>
<p>The objective of ML is to find an optimal mapping based on training data and other prior knowledge.</p>
<section id="functional-regression">
<h2>Functional regression<a class="headerlink" href="#functional-regression" title="Permalink to this headline">¶</a></h2>
<p>Linear regression</p>
<p><span class="math notranslate nohighlight">\( y = ax + b \)</span></p>
<img alt="linear_regression" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Linear_regression.svg/1024px-Linear_regression.svg.png" width="400"/>
<p><em>Uses:</em> <strong>Prediction of continous value output</strong></p>
</section>
<section id="logistic-regression">
<h2>Logistic regression<a class="headerlink" href="#logistic-regression" title="Permalink to this headline">¶</a></h2>
<p>Probability of observing certain outcome as a function of input <span class="math notranslate nohighlight">\(x\)</span>:</p>
<p><span class="math notranslate nohighlight">\( \log(\frac{p}{1-p}) = \beta_0 + \beta_1*x \)</span></p>
<img alt="logistic_regression" src="https://upload.wikimedia.org/wikipedia/commons/6/6d/Exam_pass_logistic_curve.jpeg" width="400"/>
<p><em>Uses:</em> <strong>Classification</strong></p>
</section>
<section id="support-vector-machines">
<h2>Support vector machines<a class="headerlink" href="#support-vector-machines" title="Permalink to this headline">¶</a></h2>
<p>The goal is to find a hyperplane that maximally separates data into two (or more) classes:</p>
<p><span class="math notranslate nohighlight">\( \textbf{w}^T \textbf{x} - b = 0 \)</span></p>
<p>with</p>
<p><span class="math notranslate nohighlight">\( \textbf{w}^T \textbf{x} - b \geq 1 \)</span> for <span class="math notranslate nohighlight">\( \color{blue}{\mbox{class 1}} \)</span> <BR>
<span class="math notranslate nohighlight">\( \textbf{w}^T \textbf{x} - b \leq 1 \)</span> for <span class="math notranslate nohighlight">\( \color{green}{\mbox{class 2}} \)</span></p>
<img alt="support_vector_machine" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/SVM_margin.png/800px-SVM_margin.png" width="300"/>
<p><em>Uses:</em> <strong>Classification</strong></p>
</section>
<section id="decision-trees-and-random-forests">
<h2>Decision Trees and Random Forests<a class="headerlink" href="#decision-trees-and-random-forests" title="Permalink to this headline">¶</a></h2>
<p>Decision trees generete discrete outcomes from input data based on a series of ‘decisions’.</p>
<p>Random forest methods combine output from multiple decision trees based on random subsets of input data.</p>
<img alt="random_forest" src="https://www.tibco.com/sites/tibco/files/media_entity/2021-05/random-forest-diagram.svg" width="500"/>
<p><em>Uses:</em> <strong>Classification</strong></p>
</section>
<section id="hidden-markov-models">
<h2>Hidden Markov Models<a class="headerlink" href="#hidden-markov-models" title="Permalink to this headline">¶</a></h2>
<p>Markov model describes transition probabilities between (hidden) states <span class="math notranslate nohighlight">\(X_i\)</span> and encodes probabilities of possible outcomes <span class="math notranslate nohighlight">\(y_i\)</span>.</p>
<img alt="hidden_markov_model" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8a/HiddenMarkovModel.svg/1920px-HiddenMarkovModel.svg.png" width="400"/>
<p><em>Uses:</em> <strong>Analysis, data encoding, classification</strong></p>
</section>
<section id="neural-networks">
<h2>Neural Networks<a class="headerlink" href="#neural-networks" title="Permalink to this headline">¶</a></h2>
<p>Connect input to output via matrix operations and activation functions. Multiple network layers can be combined.</p>
<img alt="neural-network" src="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-02/neural-network.png" width="500"/>
<p><em>Uses:</em> <strong>Regression, classification, analysis, encoding, generation</strong></p>
</section>
<section id="neural-network-architectures">
<h2>Neural Network Architectures<a class="headerlink" href="#neural-network-architectures" title="Permalink to this headline">¶</a></h2>
<p>Neural networks often involve many layers (deep learning).</p>
<img alt="mlp" src="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-02/mlp.png" width="500"/></section>
<section id="activation-functions">
<h2>Activation functions<a class="headerlink" href="#activation-functions" title="Permalink to this headline">¶</a></h2>
<p>Activation functions are essential for modeling non-linear relationships and for gaining the full benefit of neural networks.</p>
<img alt="activation_functions" src="https://hsf-training.github.io/hsf-training-ml-webpage/plots/act_functions.png" width=700/>
<p><a class="reference external" href="https://ml-cheatsheet.readthedocs.io/en/latest/activation_functions.html">Glossary of activation functions</a></p>
</section>
</section>
<section id="ml-in-practice">
<h1>ML in practice<a class="headerlink" href="#ml-in-practice" title="Permalink to this headline">¶</a></h1>
<section id="define-problem-suitable-for-ml">
<h2>Define problem suitable for ML<a class="headerlink" href="#define-problem-suitable-for-ml" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>What will be the input?</p></li>
<li><p>What will be the output?</p></li>
<li><p>What are the performance expectations?</p></li>
</ul>
</section>
<section id="input-data-features">
<h2>Input data features<a class="headerlink" href="#input-data-features" title="Permalink to this headline">¶</a></h2>
<p>A good choice of input data features is essential for the success of machine learning.</p>
<ul class="simple">
<li><p>general molecular properties (composition, mass, charge)</p></li>
<li><p>atomic coordinates (subject to rotational variance)</p></li>
<li><p>internal coordinates (distances, angles)</p></li>
<li><p>dynamic and ensemble information</p></li>
<li><p>sequences and multiple sequence alignments</p></li>
<li><p>classification based on previous knowledge</p></li>
<li><p>experimental data (<em>e.g.</em> density maps)</p></li>
</ul>
</section>
<section id="target-output-data">
<h2>Target  output data<a class="headerlink" href="#target-output-data" title="Permalink to this headline">¶</a></h2>
<p>The target output data should reflect the problem at hand and the availability of high-quality training data.</p>
<ul class="simple">
<li><p>Continuous values (<em>e.g.</em> energies, forces, molecular properties)</p></li>
<li><p>Classification (<em>e.g.</em> secondary structure, topology, function)</p></li>
<li><p>Latent space projection</p></li>
<li><p>Embedding (encoding of data for further use)</p></li>
<li><p>Distributions (<em>e.g.</em> distances, angles)</p></li>
<li><p>Interactions (<em>e.g.</em> intra-/intermolecular contacts, ligands, ions)</p></li>
<li><p>Structures (or parts of it)</p></li>
<li><p>Dynamic ensembles (or aspects of dynamics)</p></li>
<li><p>Quality assessement (<em>e.g.</em> model accuracy or experimental uncertainties)</p></li>
</ul>
</section>
<section id="model-design">
<h2>Model design<a class="headerlink" href="#model-design" title="Permalink to this headline">¶</a></h2>
<p>The main consideration is the balance between model complexity, accuracy, and ease of training.</p>
<ul class="simple">
<li><p><strong>Neural networks</strong> are flexible and powerful but may be difficult to train</p></li>
<li><p><strong>Deep networks</strong> may be more accurate and transferable but require more data</p></li>
<li><p>Deep networks are more difficulty to train than shallow models</p></li>
<li><p>Optimal model architecture should <strong>match input/output data shape</strong> (→ next week)</p></li>
<li><p>Computer hardware may limit model choices</p></li>
</ul>
<p>Start from established models! (→ next week)</p>
<p>Model choices and <strong>hyper-parameters</strong> should be optimized as part of model training.</p>
</section>
<section id="model-training">
<h2>Model training<a class="headerlink" href="#model-training" title="Permalink to this headline">¶</a></h2>
<p>The goal of training a specific model is to find optimal weights.</p>
<p>This is the key step of machine learning that requires most effort and computer resources.</p>
<img alt="gpu_card" src="https://assets.nvidia.partners/images/png/3080-ti-back-300x198.png" width=300/></section>
<section id="how-do-we-know-which-weights-are-optimal">
<h2>How do we know which weights are optimal?<a class="headerlink" href="#how-do-we-know-which-weights-are-optimal" title="Permalink to this headline">¶</a></h2>
<p>We define a loss function based on training data, e.g. MSE (mean-squared error) that should be minimized:</p>
<div class="math notranslate nohighlight">
\[
J_{MSE} = \frac{1}{N} \sum_{k=1}^{N}(y_k-\hat{y}_k)^2
\]</div>
<p><span class="math notranslate nohighlight">\(y_k(\textbf{x}_{k},\textbf{w},\textbf{p})\)</span> is the model-predicted output given weights <span class="math notranslate nohighlight">\(\textbf{w}\)</span> and model parameters <span class="math notranslate nohighlight">\(\textbf{p}\)</span> for training data item <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\hat{y}_k\)</span> is the expected output from the training data.</p>
</section>
<section id="how-do-we-find-optimal-weights">
<h2>How do we find optimal weights?<a class="headerlink" href="#how-do-we-find-optimal-weights" title="Permalink to this headline">¶</a></h2>
<p>We typically use a <strong>gradient descent minimizer</strong> (SGD: Stochastic Gradient Descent; <strong>Adam</strong>):</p>
<img alt="gradient_descent" src="http://rasbt.github.io/mlxtend/user_guide/general_concepts/gradient-optimization_files/ball.png" width=600/>
<p>The minimizer updates weights iteratively according to: <span class="math notranslate nohighlight">\(w_{new} = w_{old} - \lambda \frac{\partial J(w)}{\partial w} \)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda\)</span> is the <strong>learning rate</strong> and a key parameter that may be varied during optimization.</p>
</section>
<section id="how-do-we-obtain-gradients">
<h2>How do we obtain gradients?<a class="headerlink" href="#how-do-we-obtain-gradients" title="Permalink to this headline">¶</a></h2>
<p>Gradients are usually obtained via <strong>back-propagation</strong>, <em>i.e.</em> application of the chain rule.</p>
<img alt="backprop" src="https://github.com/ADicksonLab/ml4md-jb/raw/main/Week-02/backprop.png" width="800"/></section>
<section id="when-do-we-stop-with-training">
<h2>When do we stop with training?<a class="headerlink" href="#when-do-we-stop-with-training" title="Permalink to this headline">¶</a></h2>
<p>When the loss function stops decreasing.</p>
<p>It is better to monitor model performance on a <strong>validation set</strong> and stop when loss function on validation set starts to increase (indicates overfitting).</p>
<img alt="training_validation" src="https://i.stack.imgur.com/rB6J5.png" width=500/>
</section>
<section id="how-do-we-optimize-training-performance">
<h2>How do we optimize training performance?<a class="headerlink" href="#how-do-we-optimize-training-performance" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Use <strong>GPUs</strong> or <strong>TPUs</strong> with lots of memory.</p></li>
<li><p><strong>Batch processing</strong> to manage large training data sets.</p></li>
<li><p>Adaptive learning rate (start slow, faster steps once optimization converges)</p></li>
<li><p>Use pre-trained models and apply <strong>transfer learning</strong></p></li>
<li><p>Explore different model architectures and different activation functions</p></li>
<li><p><strong>Regularize input data</strong> (training is easiest with values in 0-1 range)</p></li>
</ul>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>Data is critical for machine learning. The data should provide reliable mappings between input features and target output data from which a model can be learned.</p>
<p>To develop rigorous models, data should be divided into three sets:</p>
<ul class="simple">
<li><p><strong>training data</strong> (70-90%): these data are used directly for training the model</p></li>
<li><p><strong>validation data</strong> (10-30%): these data are used for testing model performance during training to determine when to stop and to optimize hyper-parameters</p></li>
<li><p><strong>test data</strong>: these (separate) data are used for evaluating the accuracy of the final models and may consist of benchmarks that allow comparison with other methods or reference data from physical theory or experiments</p></li>
</ul>
<p>Splitting the initial data into training and validation sets should be repeated randomly.</p>
</section>
<section id="data-biases-and-incorporation-of-additional-knowledge">
<h2>Data biases and incorporation of additional knowledge<a class="headerlink" href="#data-biases-and-incorporation-of-additional-knowledge" title="Permalink to this headline">¶</a></h2>
<p>ML models perform best on domains covered extensively input data and transfer poorly to other scenarios where no or little training data was available.</p>
<p>To prevent bias, training data should uniformly cover the broadest possible range of scenarios.</p>
<p><strong>Data augmentation</strong> may provide additional data for areas not well-covered initially, <em>e.g.</em> for trivial cases.</p>
<p>Training data may be supplemented by <strong>constraints based on other knowledge</strong> that can be applied during training, <em>e.g.</em> physical constraints that disallow atom overlap or negative output values for properties that can only assume positive values.</p>
</section>
<section id="using-ml-models">
<h2>Using ML models<a class="headerlink" href="#using-ml-models" title="Permalink to this headline">¶</a></h2>
<p>Once we have a trained model, the model is easy to apply. All we need is the model architecture and the trained weights.</p>
<p>Forward evaluation is usually very fast, but can take time (and require GPU resources) for very large models. More significant time may be needed for <strong>generating the required input features</strong> (<em>e.g.</em> multiple sequence alignments as input to AlphaFold2).</p>
<p>The usefulness of a given ML model greatly depends on the training data. If the training data is limited, the model, <strong>transferability</strong> (and broader use) is probably also limited.</p>
<p>Validation of a given ML model is critical for understanding its expected accuracy.</p>
</section>
<section id="interpreting-ml-models">
<h2>Interpreting ML models<a class="headerlink" href="#interpreting-ml-models" title="Permalink to this headline">¶</a></h2>
<p>ML models are designed to make highly accurate predictions. That may be sufficient.</p>
</section>
<section id="what-if-we-want-to-understand-things">
<h2>What if we want to understand things?<a class="headerlink" href="#what-if-we-want-to-understand-things" title="Permalink to this headline">¶</a></h2>
<p>Direct inspection of optimized weights is usually not productive. Most models are too complex.</p>
<p>More insights can be gained from <strong>ablation studies</strong> that remove input features one-by-one to analyze how the model performance after training changes.</p>
<p>It may also be possible to gain insights into what information is contained in the training data by challenging the trained model with unexpected input data.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Week-02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../Week-01/W1_Lab_Python_Refresher.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Week 01 Lab: Python Refresher Course</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Alex Dickson and Michael Feig<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>